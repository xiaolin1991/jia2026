<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>好评文案自动生成器 - 快速复制</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Base font and styling */
        body {
            font-family: 'Inter', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background-color: #2c2c2c; /* Fallback dark color */
            /* 允许页面垂直滚动 */
            overflow-y: auto; 
            position: relative; /* Context for background overlay */
        }

        /* 动画美食背景容器 */
        .food-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* 使用一张高分辨率的美食集合图片 */
            background-image: url('https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center center;
            z-index: -2; /* 确保它在最底层 */
            animation: slowZoomPan 35s ease-in-out infinite alternate; /* 慢速缩放平移动画 */
        }
        
        /* 增加一个半透明的黑色遮罩层，保证文字在美食背景上清晰可见 */
        .food-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4); /* 40% 黑色遮罩 */
            z-index: -1;
        }

        /* 背景动画关键帧：慢速缩放和平移 */
        @keyframes slowZoomPan {
            0% {
                transform: scale(1) translate(0, 0);
            }
            100% {
                transform: scale(1.1) translate(-5%, 5%);
            }
        }

        /* 内容卡片样式：保持微透明和背景模糊效果 */
        .card-container {
            backdrop-filter: blur(8px); /* 略微增加模糊度 */
            background-color: rgba(255, 255, 255, 0.9); /* 90% 透明度的白色 */
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>

    <!-- 动画美食背景容器 -->
    <div class="food-bg"></div> 

    <div id="app" class="min-h-screen flex items-center justify-center p-4">
        <!-- 应用新的 card-container 样式 -->
        <div class="card-container w-full max-w-2xl shadow-2xl rounded-xl p-6 md:p-10 transition-all duration-300">
            <!-- Header -->
            <header class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">⭐⭐ 好评文案自动生成器 ⭐⭐</h1>
                <p class="text-gray-600">输入关键词，快速生成高赞好评文案，**无需 API 调用！**</p>
            </header>

            <!-- Input Section -->
            <section class="space-y-6">
                
                <!-- Keywords Input -->
                <div>
                    <label for="keywords" class="block text-sm font-medium text-gray-700 mb-1">关键信息/菜品名称 (例如: 麻辣小龙虾, 服务态度超好, 环境优雅)</label>
                    <textarea id="keywords" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-600 focus:border-blue-600 transition duration-150 shadow-inner" placeholder="请输入本次体验的关键词，例如：味道正宗、性价比高、下次还来"></textarea>
                </div>

                <!-- Generation Options (Flexible UI for future integration) -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="modelSelect" class="block text-sm font-medium text-gray-700 mb-1">文案生成方式</label>
                        <select id="modelSelect" class="w-full p-3 border border-gray-300 bg-gray-100 rounded-lg cursor-not-allowed" disabled>
                            <option value="local">本地模板生成 (无需API)</option>
                            <option value="placeholder1" disabled>API调用 (已禁用)</option>
                        </select>
                    </div>
                    <div>
                        <label for="reviewLength" class="block text-sm font-medium text-gray-700 mb-1">文案长度要求</label>
                        <select id="reviewLength" class="w-full p-3 border border-gray-300 bg-white rounded-lg focus:ring-blue-600 focus:border-blue-600 transition duration-150">
                            <option value="short">简短有力 (约50字)</option>
                            <option value="medium" selected>详细高赞 (约100字)</option>
                            <option value="long">超长篇幅 (约150字)</option>
                        </select>
                    </div>
                </div>

                <!-- Action Button -->
                <button onclick="handleGenerateClick()" id="generateBtn" class="w-full flex items-center justify-center py-3 px-4 border border-transparent text-lg font-bold rounded-lg text-white bg-red-500 hover:bg-red-600 focus:ring-4 focus:ring-red-500 focus:ring-opacity-50 transition duration-150 shadow-lg hover:shadow-xl transform hover:scale-[1.01]">
                    <span id="btnText">✨ 自动生成好评文案 (本地)</span>
                    <svg id="loadingSpinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </button>
            </section>

            <!-- Output Section -->
            <section id="outputSection" class="mt-8 pt-6 border-t border-gray-300">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    <svg class="w-6 h-6 mr-2 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944c-3.141 1.055-5.83 3.614-7.618 6.944-1.788 3.33-2.115 7.152-.927 10.598C4.542 20.373 7.027 21 9.5 21h5.04c2.473 0 4.958-.627 7.045-2.514 1.188-3.446.861-7.268-.927-10.598z"></path></svg>
                    好评文案结果
                </h2>
                
                <div id="reviewOutput" class="min-h-[100px] bg-gray-100 p-4 border border-gray-300 rounded-lg text-gray-800 whitespace-pre-wrap flex items-center justify-center text-center shadow-inner">
                    <p class="text-gray-400">请在上方输入关键词后，点击按钮生成好评。</p>
                </div>

                <!-- 移除了原有的复制按钮 -->
            </section>

            <!-- Toast Notification -->
            <div id="toast" class="fixed bottom-5 left-1/2 transform -translate-x-1/2 p-3 bg-gray-800 text-white text-sm rounded-lg shadow-xl opacity-0 transition-opacity duration-300 pointer-events-none">
                复制成功！
            </div>
            
        </div>
    </div>

    <script>
        // Canvas Global Variables Check (Not used anymore, but kept for context)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        // DOM Elements
        const keywordsInput = document.getElementById('keywords');
        const reviewLengthSelect = document.getElementById('reviewLength');
        const generateBtn = document.getElementById('generateBtn');
        const btnText = document.getElementById('btnText');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const reviewOutput = document.getElementById('reviewOutput');
        const toast = document.getElementById('toast');
        
        // --- Utility Functions ---

        function showToast(message) {
            toast.textContent = message;
            toast.style.opacity = '1';
            setTimeout(() => {
                toast.style.opacity = '0';
            }, 2000);
        }
        
        // 核心复制函数
        function performCopy(textToCopy) {
            // 检查内容是否是占位符或错误信息
            if (!textToCopy || textToCopy.includes("请输入有效的关键词")) {
                 return false;
            }
            try {
                // 使用 execCommand('copy') 实现跨环境复制
                const textarea = document.createElement('textarea');
                textarea.value = textToCopy;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showToast('好评文案已自动复制成功！');
                return true;
            } catch (err) {
                showToast('自动复制失败，请手动复制。');
                console.error('Auto copy failed:', err);
                return false;
            }
        }

        function setGenerating(isGenerating) {
            generateBtn.disabled = isGenerating;
            
            // 移除了 copyBtn 相关的逻辑
            if (isGenerating) {
                btnText.textContent = '生成中...';
                loadingSpinner.classList.remove('hidden');
                reviewOutput.innerHTML = '<p class="text-center text-red-500 font-semibold">正在为您生成文案...</p>';
            } else {
                btnText.textContent = '✨ 自动生成好评文案 (本地)';
                loadingSpinner.classList.add('hidden');
            }
        }

        // --- Core Local Generation Function ---
        
        // 核心模板库
        const baseTemplates = [
            "味道超赞，简直是舌尖上的享受！",
            "服务态度超级棒，店员都很亲切热情。",
            "环境很干净很舒适，装修风格也很喜欢。",
            "性价比很高，量大实惠，值得推荐！",
            "这次的体验非常满意，下次还会再来的！",
            "菜品份量足，食材新鲜，看得出店家用心了。",
            "家人朋友都说好，已经推荐给身边所有人啦！",
            "出乎意料的好，完全超出了预期，必须五星。",
        ];

        // 连接词和情绪词库
        const connectors = ["，而且", "，另外", "；尤其是", "！最棒的是"];
        const emotions = ["超开心", "太满足了", "非常惊喜", "非常地道"];
        
        function generateLocalReview(userKeywords, lengthKey) {
            const keywordsArray = userKeywords.split(/[，,、\s]+/).filter(k => k.trim().length > 0);
            if (keywordsArray.length === 0) return "请输入有效的关键词，如菜品名或服务评价。";

            // 1. 提取随机关键词
            const keyword1 = keywordsArray[Math.floor(Math.random() * keywordsArray.length)];
            let keyword2 = null;
            if (keywordsArray.length > 1) {
                // 确保第二个关键词和第一个不同
                let index2 = Math.floor(Math.random() * keywordsArray.length);
                if (keywordsArray[index2] === keyword1) {
                     index2 = (index2 + 1) % keywordsArray.length;
                }
                keyword2 = keywordsArray[index2];
            }
            
            // 2. 初始核心文案
            let review = `这家店真是宝藏！${keyword1}做得特别好，味道棒极了，吃得我${emotions[Math.floor(Math.random() * emotions.length)]}。`;

            // 3. 注入第二个关键词和连接词
            if (keyword2) {
                review += `${connectors[Math.floor(Math.random() * connectors.length)]}${keyword2}也让人印象深刻。`;
            } else {
                 review += baseTemplates[Math.floor(Math.random() * baseTemplates.length)];
            }
            
            // 4. 根据长度要求填充模板
            let targetLength = 100; // Medium default
            if (lengthKey === 'short') targetLength = 50;
            if (lengthKey === 'long') targetLength = 150;

            let loopCount = 0;
            while (review.length < targetLength && loopCount < 3) { // 最多额外填充3次
                const filler = baseTemplates[Math.floor(Math.random() * baseTemplates.length)];
                if (!review.includes(filler.substring(0, 5))) { // 避免短时间内重复太多
                    review += " " + filler;
                }
                loopCount++;
            }
            
            // 5. 结尾总结
            review += " 总之，是一次非常愉快的体验，强烈推荐大家去尝试！⭐⭐⭐⭐⭐";

            return review.trim();
        }


        // --- Event Handlers ---

        async function handleGenerateClick() {
            const keywords = keywordsInput.value.trim();

            if (!keywords) {
                reviewOutput.innerHTML = '<p class="text-center text-red-500 font-semibold">请先输入您的关键词，描述一下您的体验！</p>';
                // 确保复制动作不会执行
                performCopy(null); 
                return;
            }

            // 本地生成速度快，设置短暂的加载状态
            setGenerating(true); 
            
            // 模拟短暂延迟，让用户看到加载动画 (可选，但体验更好)
            await new Promise(resolve => setTimeout(resolve, 300)); 

            const lengthKey = reviewLengthSelect.value;
            const generatedText = generateLocalReview(keywords, lengthKey);
            
            // 更新输出
            if (generatedText.includes("请输入有效的关键词")) {
                 reviewOutput.innerHTML = `<p class="text-center text-red-500 font-semibold">${generatedText}</p>`;
            } else {
                 reviewOutput.textContent = generatedText;
                 // 自动复制文案
                 performCopy(generatedText);
            }

            // 结束加载状态
            setGenerating(false);
        }
        
        // Initial state update to ensure copy button is disabled on load
        window.onload = () => {
             // Set initial output content to placeholder text in case browser state persists
            reviewOutput.innerHTML = '<p class="text-gray-400">请在上方输入关键词后，点击按钮生成好评。</p>';
        }

    </script>

</body>
</html>
